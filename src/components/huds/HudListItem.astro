---
const { hud, expanded = false, carousel = false } = Astro.props;
---

<style>
  .card-img-top {
    aspect-ratio: 16 / 9;
    background-position: center;
    background-size: contain;
    background-repeat: no-repeat;
    background-color: #151515;
   }

   .btn-outline-secondary {
    --bs-btn-padding-y: 0;
    color: #b2dfdb;
    box-shadow: none;
    border: none;
    z-index: 2;
   }

   .btn-outline-secondary:hover {
    color: var(--bs-btn-hover-color);
   }
</style>

<div class="card">
  {(carousel && (
    <div class="card-img-top">
      <div class="carousel slide carousel-fade h-100">
        <div class="carousel-inner h-100">
          {hud.resourceUrls.map((resource, index) =>
            <div class={`carousel-item h-100 ${index == 0 ? "active" : ""}`} data-bs-interval={index == 0 ? "400" : ""}>
              {
                (resource.startsWith("https://youtube.com/") && (
                  <iframe width="100%" height="100%" src={resource} title={`${hud.resources[index]}`} frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                )) || (<img src={resource} class="d-block w-100 position-relative translate-middle-y top-50" loading="lazy" alt={`${hud.resources[index]}`} />)
              }
            </div>)
          }
        </div>
      </div>
    </div>)) || (<div class="card-img-top" style={`background-image: url('${hud.bannerUrl}')`}></div>)}
  <div class="card-body">
    <h5 class="card-title">{hud.name}
      {hud.outdated && (<small class="d-inline-block position-relative text-danger" style="z-index: 2" data-bs-toggle="tooltip" data-bs-title="Outdated/Incompatible"><span class="fas fa-circle-exclamation fa-fw"></span></small>)}
      {hud.prerelease && (<small class="d-inline-block position-relative text-warning" style="z-index: 2" data-bs-toggle="tooltip" data-bs-title="Preview release"><span class="fas fa-flask fa-fw"></span></small>)}
    </h5>
    <h6 class="card-subtitle mb-2 text-muted">{hud.author}</h6>
    <a href={`/huds/page/${hud.id}/`} class="card-link stretched-link d-inline-block py-2 my-1">View HUD</a>
    {expanded && (<a href={hud.downloadUrl} class={`btn btn-outline-secondary ms-3 py-2 my-1 position-relative ${hud.outdated ? "d-none" : ""}`}><span class="fas fa-download fa-fw"></span></a>
    <br>
    <span class="text-muted">
      Last updated <strong>{hud.publishDate.toLocaleDateString('en-us', { year: "numeric", month: "short", day: "numeric"})}</strong>
    </span>)}
  </div>
</div>
